{"ast":null,"code":"import { isCloudflareWorkers } from '../runtime/env.js';\nfunction unusable(name) {\n  let prop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'algorithm.name';\n  return new TypeError(`CryptoKey does not support this operation, its ${prop} must be ${name}`);\n}\nfunction isAlgorithm(algorithm, name) {\n  return algorithm.name === name;\n}\nfunction getHashLength(hash) {\n  return parseInt(hash.name.slice(4), 10);\n}\nfunction getNamedCurve(alg) {\n  switch (alg) {\n    case 'ES256':\n      return 'P-256';\n    case 'ES384':\n      return 'P-384';\n    case 'ES512':\n      return 'P-521';\n    default:\n      throw new Error('unreachable');\n  }\n}\nfunction checkUsage(key, usages) {\n  if (usages.length && !usages.some(expected => key.usages.includes(expected))) {\n    let msg = 'CryptoKey does not support this operation, its usages must include ';\n    if (usages.length > 2) {\n      const last = usages.pop();\n      msg += `one of ${usages.join(', ')}, or ${last}.`;\n    } else if (usages.length === 2) {\n      msg += `one of ${usages[0]} or ${usages[1]}.`;\n    } else {\n      msg += `${usages[0]}.`;\n    }\n    throw new TypeError(msg);\n  }\n}\nexport function checkSigCryptoKey(key, alg) {\n  switch (alg) {\n    case 'HS256':\n    case 'HS384':\n    case 'HS512':\n      {\n        if (!isAlgorithm(key.algorithm, 'HMAC')) throw unusable('HMAC');\n        const expected = parseInt(alg.slice(2), 10);\n        const actual = getHashLength(key.algorithm.hash);\n        if (actual !== expected) throw unusable(`SHA-${expected}`, 'algorithm.hash');\n        break;\n      }\n    case 'RS256':\n    case 'RS384':\n    case 'RS512':\n      {\n        if (!isAlgorithm(key.algorithm, 'RSASSA-PKCS1-v1_5')) throw unusable('RSASSA-PKCS1-v1_5');\n        const expected = parseInt(alg.slice(2), 10);\n        const actual = getHashLength(key.algorithm.hash);\n        if (actual !== expected) throw unusable(`SHA-${expected}`, 'algorithm.hash');\n        break;\n      }\n    case 'PS256':\n    case 'PS384':\n    case 'PS512':\n      {\n        if (!isAlgorithm(key.algorithm, 'RSA-PSS')) throw unusable('RSA-PSS');\n        const expected = parseInt(alg.slice(2), 10);\n        const actual = getHashLength(key.algorithm.hash);\n        if (actual !== expected) throw unusable(`SHA-${expected}`, 'algorithm.hash');\n        break;\n      }\n    case isCloudflareWorkers() && 'EdDSA':\n      {\n        if (!isAlgorithm(key.algorithm, 'NODE-ED25519')) throw unusable('NODE-ED25519');\n        break;\n      }\n    case 'EdDSA':\n      {\n        if (key.algorithm.name !== 'Ed25519' && key.algorithm.name !== 'Ed448') {\n          throw unusable('Ed25519 or Ed448');\n        }\n        break;\n      }\n    case 'ES256':\n    case 'ES384':\n    case 'ES512':\n      {\n        if (!isAlgorithm(key.algorithm, 'ECDSA')) throw unusable('ECDSA');\n        const expected = getNamedCurve(alg);\n        const actual = key.algorithm.namedCurve;\n        if (actual !== expected) throw unusable(expected, 'algorithm.namedCurve');\n        break;\n      }\n    default:\n      throw new TypeError('CryptoKey does not support this operation');\n  }\n  for (var _len = arguments.length, usages = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    usages[_key - 2] = arguments[_key];\n  }\n  checkUsage(key, usages);\n}\nexport function checkEncCryptoKey(key, alg) {\n  switch (alg) {\n    case 'A128GCM':\n    case 'A192GCM':\n    case 'A256GCM':\n      {\n        if (!isAlgorithm(key.algorithm, 'AES-GCM')) throw unusable('AES-GCM');\n        const expected = parseInt(alg.slice(1, 4), 10);\n        const actual = key.algorithm.length;\n        if (actual !== expected) throw unusable(expected, 'algorithm.length');\n        break;\n      }\n    case 'A128KW':\n    case 'A192KW':\n    case 'A256KW':\n      {\n        if (!isAlgorithm(key.algorithm, 'AES-KW')) throw unusable('AES-KW');\n        const expected = parseInt(alg.slice(1, 4), 10);\n        const actual = key.algorithm.length;\n        if (actual !== expected) throw unusable(expected, 'algorithm.length');\n        break;\n      }\n    case 'ECDH':\n      {\n        switch (key.algorithm.name) {\n          case 'ECDH':\n          case 'X25519':\n          case 'X448':\n            break;\n          default:\n            throw unusable('ECDH, X25519, or X448');\n        }\n        break;\n      }\n    case 'PBES2-HS256+A128KW':\n    case 'PBES2-HS384+A192KW':\n    case 'PBES2-HS512+A256KW':\n      if (!isAlgorithm(key.algorithm, 'PBKDF2')) throw unusable('PBKDF2');\n      break;\n    case 'RSA-OAEP':\n    case 'RSA-OAEP-256':\n    case 'RSA-OAEP-384':\n    case 'RSA-OAEP-512':\n      {\n        if (!isAlgorithm(key.algorithm, 'RSA-OAEP')) throw unusable('RSA-OAEP');\n        const expected = parseInt(alg.slice(9), 10) || 1;\n        const actual = getHashLength(key.algorithm.hash);\n        if (actual !== expected) throw unusable(`SHA-${expected}`, 'algorithm.hash');\n        break;\n      }\n    default:\n      throw new TypeError('CryptoKey does not support this operation');\n  }\n  for (var _len2 = arguments.length, usages = new Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n    usages[_key2 - 2] = arguments[_key2];\n  }\n  checkUsage(key, usages);\n}","map":{"version":3,"names":["isCloudflareWorkers","unusable","name","prop","TypeError","isAlgorithm","algorithm","getHashLength","hash","parseInt","slice","getNamedCurve","alg","Error","checkUsage","key","usages","length","some","expected","includes","msg","last","pop","join","checkSigCryptoKey","actual","namedCurve","checkEncCryptoKey"],"sources":["C:/Users/hherenu/Desktop/Proyectos/login/node_modules/jose/dist/browser/lib/crypto_key.js"],"sourcesContent":["import { isCloudflareWorkers } from '../runtime/env.js';\r\nfunction unusable(name, prop = 'algorithm.name') {\r\n    return new TypeError(`CryptoKey does not support this operation, its ${prop} must be ${name}`);\r\n}\r\nfunction isAlgorithm(algorithm, name) {\r\n    return algorithm.name === name;\r\n}\r\nfunction getHashLength(hash) {\r\n    return parseInt(hash.name.slice(4), 10);\r\n}\r\nfunction getNamedCurve(alg) {\r\n    switch (alg) {\r\n        case 'ES256':\r\n            return 'P-256';\r\n        case 'ES384':\r\n            return 'P-384';\r\n        case 'ES512':\r\n            return 'P-521';\r\n        default:\r\n            throw new Error('unreachable');\r\n    }\r\n}\r\nfunction checkUsage(key, usages) {\r\n    if (usages.length && !usages.some((expected) => key.usages.includes(expected))) {\r\n        let msg = 'CryptoKey does not support this operation, its usages must include ';\r\n        if (usages.length > 2) {\r\n            const last = usages.pop();\r\n            msg += `one of ${usages.join(', ')}, or ${last}.`;\r\n        }\r\n        else if (usages.length === 2) {\r\n            msg += `one of ${usages[0]} or ${usages[1]}.`;\r\n        }\r\n        else {\r\n            msg += `${usages[0]}.`;\r\n        }\r\n        throw new TypeError(msg);\r\n    }\r\n}\r\nexport function checkSigCryptoKey(key, alg, ...usages) {\r\n    switch (alg) {\r\n        case 'HS256':\r\n        case 'HS384':\r\n        case 'HS512': {\r\n            if (!isAlgorithm(key.algorithm, 'HMAC'))\r\n                throw unusable('HMAC');\r\n            const expected = parseInt(alg.slice(2), 10);\r\n            const actual = getHashLength(key.algorithm.hash);\r\n            if (actual !== expected)\r\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\r\n            break;\r\n        }\r\n        case 'RS256':\r\n        case 'RS384':\r\n        case 'RS512': {\r\n            if (!isAlgorithm(key.algorithm, 'RSASSA-PKCS1-v1_5'))\r\n                throw unusable('RSASSA-PKCS1-v1_5');\r\n            const expected = parseInt(alg.slice(2), 10);\r\n            const actual = getHashLength(key.algorithm.hash);\r\n            if (actual !== expected)\r\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\r\n            break;\r\n        }\r\n        case 'PS256':\r\n        case 'PS384':\r\n        case 'PS512': {\r\n            if (!isAlgorithm(key.algorithm, 'RSA-PSS'))\r\n                throw unusable('RSA-PSS');\r\n            const expected = parseInt(alg.slice(2), 10);\r\n            const actual = getHashLength(key.algorithm.hash);\r\n            if (actual !== expected)\r\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\r\n            break;\r\n        }\r\n        case isCloudflareWorkers() && 'EdDSA': {\r\n            if (!isAlgorithm(key.algorithm, 'NODE-ED25519'))\r\n                throw unusable('NODE-ED25519');\r\n            break;\r\n        }\r\n        case 'EdDSA': {\r\n            if (key.algorithm.name !== 'Ed25519' && key.algorithm.name !== 'Ed448') {\r\n                throw unusable('Ed25519 or Ed448');\r\n            }\r\n            break;\r\n        }\r\n        case 'ES256':\r\n        case 'ES384':\r\n        case 'ES512': {\r\n            if (!isAlgorithm(key.algorithm, 'ECDSA'))\r\n                throw unusable('ECDSA');\r\n            const expected = getNamedCurve(alg);\r\n            const actual = key.algorithm.namedCurve;\r\n            if (actual !== expected)\r\n                throw unusable(expected, 'algorithm.namedCurve');\r\n            break;\r\n        }\r\n        default:\r\n            throw new TypeError('CryptoKey does not support this operation');\r\n    }\r\n    checkUsage(key, usages);\r\n}\r\nexport function checkEncCryptoKey(key, alg, ...usages) {\r\n    switch (alg) {\r\n        case 'A128GCM':\r\n        case 'A192GCM':\r\n        case 'A256GCM': {\r\n            if (!isAlgorithm(key.algorithm, 'AES-GCM'))\r\n                throw unusable('AES-GCM');\r\n            const expected = parseInt(alg.slice(1, 4), 10);\r\n            const actual = key.algorithm.length;\r\n            if (actual !== expected)\r\n                throw unusable(expected, 'algorithm.length');\r\n            break;\r\n        }\r\n        case 'A128KW':\r\n        case 'A192KW':\r\n        case 'A256KW': {\r\n            if (!isAlgorithm(key.algorithm, 'AES-KW'))\r\n                throw unusable('AES-KW');\r\n            const expected = parseInt(alg.slice(1, 4), 10);\r\n            const actual = key.algorithm.length;\r\n            if (actual !== expected)\r\n                throw unusable(expected, 'algorithm.length');\r\n            break;\r\n        }\r\n        case 'ECDH': {\r\n            switch (key.algorithm.name) {\r\n                case 'ECDH':\r\n                case 'X25519':\r\n                case 'X448':\r\n                    break;\r\n                default:\r\n                    throw unusable('ECDH, X25519, or X448');\r\n            }\r\n            break;\r\n        }\r\n        case 'PBES2-HS256+A128KW':\r\n        case 'PBES2-HS384+A192KW':\r\n        case 'PBES2-HS512+A256KW':\r\n            if (!isAlgorithm(key.algorithm, 'PBKDF2'))\r\n                throw unusable('PBKDF2');\r\n            break;\r\n        case 'RSA-OAEP':\r\n        case 'RSA-OAEP-256':\r\n        case 'RSA-OAEP-384':\r\n        case 'RSA-OAEP-512': {\r\n            if (!isAlgorithm(key.algorithm, 'RSA-OAEP'))\r\n                throw unusable('RSA-OAEP');\r\n            const expected = parseInt(alg.slice(9), 10) || 1;\r\n            const actual = getHashLength(key.algorithm.hash);\r\n            if (actual !== expected)\r\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\r\n            break;\r\n        }\r\n        default:\r\n            throw new TypeError('CryptoKey does not support this operation');\r\n    }\r\n    checkUsage(key, usages);\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}